{ "name": "wix-paid-plans",
  "mixes": [],
  "labels": [],
  "location":
    { "filename": "paid-plans.js",
      "lineno": 88 },
  "docs":
    { "summary": "The wix-paid-plans module contains functionality for working with\n paid plans from client-side code.",
      "description":
        [ "To process paid plans on your site:",
          "",
          " * Set up your site to accept payments as described in <a href=\"https://support.wix.com/en/article/about-accepting-payments\" target=\"_blank\">About Accepting Payments</a>.",
          "",
          " * Set up your site to offer paid plans as described in <a href=\"https://support.wix.com/en/article/about-paid-plans\" target=\"_blank\">About Paid Plans</a>. When setting up your site to accept paid plans, <a href=\"https://support.wix.com/en/article/creating-a-plan-in-paid-plans\" target=\"_blank\"> define the plans you want to offer</a>,",
          "    including the payment method.",
          "",
          "",
          " Once plans are set up, you can use the API to:",
          "",
          " 1. Get information about paid plans.",
          " 1. Let site visitors purchase a plan, using one of the following alternatives:",
          "",
          " * __Direct purchase of a plan__:",
          "",
          "   Same functionality as when purchasing a plan with the Paid Plans app. Everything is",
          "   handled, from ordering the plan, through paying for the plan. So if you want to implement",
          "   standard paid plan processing \"as is,\" call the purchase API, as described",
          "   below.",
          "",
          " * __Customized purchase of a plan__:",
          "",
          "   Let site visitors order a plan for future purchase (such as after a visitor enters payment information).",
          "   This alternative lets you customize the entire process of selecting, ordering, and",
          "   paying for a plan. You can add elements, such as confirmation lightboxes and forms, to customize the visitor experience. Payment",
          "   is processed with Wix Pay. This is described below under [Customized Paid Plan Purchases](wix-paid-plans.html#paid-plan-customize).",
          "",
          "",
          "",
          " <h3 id=\"paid-plan-lifecycle\">Direct Purchase of a Paid Plan</h3>",
          "",
          " The direct-purchase paid plan lifecycle can be implemented using the [`purchasePlan()`](wix-paid-plans.html#purchasePlan) function.",
          " `purchasePlan` lets visitors order and buy plans in one flow as if using the Paid Plans app.",
          "",
          "",
          " The following outlines the steps in a direct-purchase lifecycle:",
          "",
          " 1. Get a list of membership plans from one of:",
          "    * A dataset connected to the Plans collection.",
          "    * A query on the Plans collection.",
          " 1. A *logged-in* site visitor selects a membership plan by clicking the plan or a button.  (If the visitor is not logged-in, the",
          "    sign up page is displayed.)",
          " 1. The corresponding event handler calls a function to handle all stages of buying the plan (ordering, purchasing, payment, and assigning the plan):",
          "    * If the plan is free, the plan is immediately ordered and is considered purchased (transaction status is \"Paid\").",
          "    * If the plan is not free, the plan is immediately ordered (transaction status is \"Pending\"). The site visitor fills in contact details and selects a payment method.",
          "",
          "",
          "",
          "",
          " <h3 id=\"paid-plan-customize\">Customized Paid Plan Purchases</h3>",
          "",
          " A customized paid plan purchase can be implemented by calling the [`orderPlan()`](wix-paid-plans.html#orderPlan) function and implementing",
          " the Wix Pay API.",
          " [`orderPlan()`](wix-paid-plans.html#orderPlan) lets visitors request plans. You",
          " can then customize the site visitors' experience before they actually pay for the plan.",
          "",
          " The following outlines the steps for customizing the paid plan purchase:",
          "",
          " 1. Get a list of membership plans from one of:",
          "    * A dataset connected to the Plans collection.",
          "    * A query on the Plans collection.",
          " 1. A *logged-in* site visitor selects a membership plan by clicking the plan or a button.  (If the visitor is not logged-in, the",
          "    sign up page is displayed.)",
          " 1. The corresponding event handler calls the [`orderPlan()`](wix-paid-plans.html#orderPlan) function to handle the initial order of a plan.",
          " 1. You create and customize a series of elements for continuing the purchase, such as lightboxes,",
          "    forms, and so on. The site visitor enters payment information using these elements.",
          " 1. Implement the Wix Pay API to accept payments, purchase the plan, and assign the plan to the visitor.",
          "",
          "",
          "",
          " To use the Paid Plans API, import `wixPaidPlans` from the `wix-paid-plans` module:",
          "",
          "   ```javascript",
          "   import wixPaidPlans from 'wix-paid-plans';",
          "   ```" ],
      "links": [],
      "examples": [],
      "extra":
        {  } },
  "properties": [],
  "operations":
    [ { "name": "orderPlan",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "planId",
              "type": "string",
              "doc": "The plan ID." } ],
        "ret":
          { "type":
              { "name": "Promise",
                "typeParams":
                  [ "wix-paid-plans.OrderResult" ] },
            "doc": "Fulfilled - The created order." },
        "locations":
          [ { "filename": "paid-plans.js",
              "lineno": 264 } ],
        "docs":
          { "summary": "Orders a paid plan.",
            "description":
              [ "To process paid plans on your site, first set up your site to offer paid plans",
                " as described in <a href=\"https://support.wix.com/en/article/about-paid-plans\" target=\"_blank\">About Paid Plans</a>.",
                " When setting up your site to accept paid plans, <a href=\"https://support.wix.com/en/article/creating-a-plan-in-paid-plans\" target=\"_blank\">",
                " define the plans you want to offer</a>.",
                "",
                " The `orderPlan()` function returns a Promise that resolves to an [`OrderResult`](wix-paid-plans.html#OrderResult)",
                " object when the visitor completes the order process. Use this result only for display purposes.",
                "",
                " Ordering a plan places an order for the plan, without actually purchasing it. You can then continue the",
                " payment process with the Wix Pay payment method, which applies the plan to the visitor on completion of payment.",
                "",
                " To understand how `orderPlan()` is used in a customized paid plan lifecycle,",
                " see [Customized Paid Plan Purchases](wix-paid-plans.html#paid-plan-customize)." ],
            "links": [],
            "examples":
              [ { "title": "Order a paid plan",
                  "body":
                    [ "import wixPaidPlans from 'wix-data';",
                      "",
                      "let planId = // Get the plan ID",
                      "",
                      "export function myOrderButton_click(event) {",
                      "  wixPaidPlans.orderPlan(planId)",
                      "    .then( (myOrder) => {",
                      "        let  myOrderId = myOrder.orderId;",
                      "        let  myWixPayOrderId = myOrder.wixPayOrderId;",
                      "        let  myStatus = myOrder.status;",
                      "    } );",
                      "  }",
                      "",
                      "",
                      "/* myOrder:",
                      " * {",
                      " *  \"orderId\": \\\"b3fb3a4d-c223-4040-8bc3-8dfdefb1bafc\\\",",
                      " *  \"wixPayOrderId\": \\\"06af8fd6-6c82-4b51-bc08-0b556aad6f4f\\\",",
                      " *  \"status\": 200",
                      " * }",
                      " */" ],
                  "extra":
                    {  } },
                { "title": "A full order plan scenario",
                  "body":
                    [ "/****************************************",
                      "* Code on a plan viewer page",
                      "*****************************************/",
                      "// For navigating to a dynamic page:",
                      "import wixLocation from 'wix-location';",
                      "// For getting data about a paid plan:",
                      "import wixData from 'wix-data';",
                      "",
                      "// If the site visitor clicks a plan's button,",
                      "// the browser relocates to that plan's page,",
                      "// with more details.",
                      "$w.onReady(function () {",
                      "   $w(\"#viewButton\").onClick( (event, $w) => {",
                      "      let slug = $w(\"#planDataset\").getCurrentItem().slug;",
                      "      wixLocation.to('/my-plans/'+ slug)",
                      "  }));",
                      "});",
                      "",
                      "",
                      "/****************************************",
                      "* Code on a plan ordering dynamic page",
                      "*****************************************/",
                      "// For a lightbox:",
                      "import wixWindow from 'wix-window';",
                      "// For Wix Pay, but any payment method is OK:",
                      "import wixPay from 'wix-pay';",
                      "// For paid plans",
                      "import paidPlans from 'wix-paid-plans';",
                      "",
                      "",
                      "$w.onReady(function () {",
                      "",
                      "   // When the collection is accessible...",
                      "   $w('#dynamicDataset').onReady( () => {",
                      "",
                      "   // Save the currently-selected plan in currentPlanObject",
                      "   const currentPlanObject = $w(\"#dynamicDataset\").getCurrentItem();",
                      "",
                      "   // Display details about the current plan",
                      "   $w('#planName').text = currentPlanObject.name;",
                      "   $w('#planDescription').text = currentPlanObject.description;",
                      "",
                      "   // Save the currently-selected plan's ID in planId. This",
                      "   // unique identifier will be used for ordering the plan.",
                      "   const planId = currentPlanObject._id;",
                      "",
                      "",
                      "   // Order the plan by button click",
                      "   $w(\"orderPlanButton\").onClick( (event) => {",
                      "",
                      "   // Provide the plan's ID to the",
                      "   // orderPlan() function. The function returns",
                      "   // an object containing the plan's properties.",
                      "   const order = paidPlans.orderPlan(planId).then(ord => {",
                      "",
                      "   const planWithOrder = {",
                      "     plan: currentPlanObject,",
                      "     order: ord",
                      "   };",
                      "",
                      "   // Use a customized lightbox to continue processing the order.",
                      "   wixWindow.openLightbox(\"orderCreated\", planWithOrder)",
                      "     .then( (data) => {",
                      "     const receivedData = data;",
                      "   });",
                      "",
                      "   });",
                      "  });",
                      " });",
                      "});",
                      "" ],
                  "extra":
                    { "description": "This example demonstrates a customized paid plans scenario. The customized elements include:\n\n\n * An intermediary page that displays all plans before ordering\n * A lightbox\n\n\n In the interest of simplicity the code does not deal with display considerations or validations\n that would normally be required to make sure users perform the flow as\n intended.\n\n The code assumes two pages:\n\n * The plan viewer page lists the plans and lets the visitor pick one.\n\n * A dynamic page shows one plan's details and lets the visitor order the plan.\n\n\n The plan viewer page has the following elements:\n\n + `planDataset`: Connects the page to the Plans collection.\n + `planRepeater`: Displays fields for each plan.\n + `viewButton`: Displays the ordering page for the selected plan.\n\n\n\nThe dynamic page has the following elements:\n\n + `dynanicDataset`: Connects the page to the Plans collection.\n + `planName`: Text element that displays the plan's name.\n + `planDescription`: Text element that displays the plan's tagline.\n + `orderPlanButton`: Performs a request to order the plan.\n + `orderCreated`: A customized lighbox. The lightbox could, for example,\n    display plan details and ask for additional confirmation." } } ],
            "extra":
              {  } },
        "extra":
          { "notes":
              [ "To work with the Paid Plans API, you need to publish your site." ] } },
      { "name": "purchasePlan",
        "labels": [],
        "nameParams": [],
        "params":
          [ { "name": "planId",
              "type": "string",
              "doc": "The plan ID." } ],
        "ret":
          { "type":
              { "name": "Promise",
                "typeParams":
                  [ "wix-paid-plans.PurchaseResult" ] },
            "doc": "Fulfilled - The created purchase." },
        "locations":
          [ { "filename": "paid-plans.js",
              "lineno": 209 } ],
        "docs":
          { "summary": "Orders and purchases a paid plan.",
            "description":
              [ "To process paid plans on your site, first set up your site to offer paid plans",
                " as described in <a href=\"https://support.wix.com/en/article/about-paid-plans\" target=\"_blank\">About Paid Plans</a>.",
                " When setting up your site to accept paid plans, <a href=\"https://support.wix.com/en/article/creating-a-plan-in-paid-plans\" target=\"_blank\"> define the plans you want to offer</a>,",
                " including the payment method.",
                "",
                " The `purchasePlan()` function returns a Promise that resolves to either a [`PurchaseResult`](wix-paid-plans.html#PurchaseResult)",
                " object when the visitor completes the purchase process for a non-free plan, or a  [`PurchaseResultFree`](wix-paid-plans.html#PurchaseResultFree)",
                " object when the visitor completes the purchase process for a free plan. Use this result only for display purposes.",
                "",
                "",
                " Purchasing a plan validates the plan, orders the plan, and continues the",
                " payment process with the Wix Pay API. After payment is complete, the plan ",
                " is assigned to the visitor.",
                "",
                " To understand the lifecycle of how `purchasePlan()` is used,",
                " see [Direct Purchase of a Paid Plan](wix-paid-plans.html#paid-plan-lifecycle)." ],
            "links": [],
            "examples":
              [ { "title": "Purchase a non-free plan on button click",
                  "body":
                    [ "import wixPaidPlans from 'wix-data';",
                      "import wixPay from 'wix-paid-plans';",
                      "",
                      "let planId = // Get the plan ID for a non-free plan",
                      "",
                      "export function myPurchaseButton_click(event) {",
                      "  wixPaidPlans.purchasePlan(planId)",
                      "    .then( (myPurchase) => {",
                      "        let  myOrderId = myPurchase.orderId;",
                      "        let  myWixPayOrderId = myPurchase.wixPayOrderId;",
                      "        let  myStatus = myPurchase.status;",
                      "    } );",
                      "  }",
                      "",
                      "",
                      "/* myPurchase:",
                      " * {",
                      " *  \"orderId\": \\\"b3fb3a4d-c223-4040-8bc3-8dfdefb1bafc\\\",",
                      " *  \"wixPayOrderId\": \\\"06af8fd6-6c82-4b51-bc08-0b556aad6f4f\\\",",
                      " *  \"status\": 200",
                      " * }",
                      " */" ],
                  "extra":
                    {  } },
                { "title": "Purchase a free plan on button click",
                  "body":
                    [ "import wixPaidPlans from 'wix-data';",
                      "import wixPay from 'wix-paid-plans';",
                      "",
                      "let planId = // Get the plan ID for a free plan",
                      "",
                      "export function myPurchaseButton_click(event) {",
                      "  wixPaidPlans.purchasePlan(planId)",
                      "    .then( (myPurchase) => {",
                      "        let  myOrderId = myPurchase.orderId;",
                      "        let  myStatus = myPurchase.status;",
                      "    } );",
                      "  }",
                      "",
                      "",
                      "/* myPurchase:",
                      " * {",
                      " *  \"orderId\": \\\"b3fb3a4d-c223-4040-8bc3-8dfdefb1bafc\\\",",
                      " *  \"status\": 200",
                      " * }",
                      " */" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          { "notes":
              [ "To work with the Paid Plans API, you need to publish your site." ] } } ],
  "callbacks": [],
  "messages":
    [ { "name": "OrderResult",
        "locations":
          [ { "filename": "paid-plans.js",
              "lineno": 198 } ],
        "docs":
          { "summary": "An object representing an order result.",
            "links":
              [ "[orderPlan( )](wix-paid-plans.html#orderPlan)" ],
            "examples":
              [ { "title": "Order a paid plan",
                  "body":
                    [ "import wixPaidPlans from 'wix-data';",
                      "",
                      "let planId = // Get the plan ID",
                      "",
                      "export function myOrderButton_click(event) {",
                      "  wixPaidPlans.orderPlan(planId)",
                      "    .then( (myOrder) => {",
                      "        let  myOrderId = myOrder.orderId;",
                      "        let  myWixPayOrderId = myOrder.wixPayOrderId;",
                      "        let  myStatus = myOrder.status;",
                      "    } );",
                      "  }",
                      "",
                      "",
                      "/* myOrder:",
                      " * {",
                      " *  \"orderId\": \\\"b3fb3a4d-c223-4040-8bc3-8dfdefb1bafc\\\",",
                      " *  \"wixPayOrderId\": \\\"06af8fd6-6c82-4b51-bc08-0b556aad6f4f\\\",",
                      " *  \"status\": 200",
                      " * }",
                      " */" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "members":
          [ { "name": "orderId",
              "type": "string",
              "doc": "ID of the order." },
            { "name": "wixPayOrderId",
              "type": "string",
              "doc": "Wix Pay ID of the order being purchased." },
            { "name": "status",
              "type": "string",
              "doc": "Status of the order, such as 200 if the order succeeded." } ],
        "extra":
          {  },
        "labels": [] },
      { "name": "PurchaseResult",
        "locations":
          [ { "filename": "paid-plans.js",
              "lineno": 177 } ],
        "docs":
          { "summary": "An object representing a purchase result for a non-free plan.",
            "links":
              [ "[purchasePlan( )](wix-paid-plans.html#purchasePlan)" ],
            "examples":
              [ { "title": "Purchase a non-free plan",
                  "body":
                    [ "import wixPaidPlans from 'wix-data';",
                      "import wixPay from 'wix-paid-plans';",
                      "",
                      "let planId = // Get the plan ID for a non-free plan",
                      "",
                      "export function myPurchaseButton_click(event) {",
                      "  wixPaidPlans.purchasePlan(planId)",
                      "    .then( (myPurchase) => {",
                      "        let  myOrderId = myPurchase.orderId;",
                      "        let  myWixPayOrderId = myPurchase.wixPayOrderId;",
                      "        let  myStatus = myPurchase.status;",
                      "    } );",
                      "  }",
                      "",
                      "",
                      "/* myPurchase:",
                      " * {",
                      " *  \"orderId\": \\\"b3fb3a4d-c223-4040-8bc3-8dfdefb1bafc\\\",",
                      " *  \"wixPayOrderId\": \\\"06af8fd6-6c82-4b51-bc08-0b556aad6f4f\\\",",
                      " *  \"status\": 200",
                      " * }",
                      " */" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "members":
          [ { "name": "orderId",
              "type": "string",
              "doc": "ID of the order being purchased." },
            { "name": "wixPayOrderId",
              "type": "string",
              "doc": "Wix Pay ID of the order being purchased. Returned for non-free plans." },
            { "name": "status",
              "type": "string",
              "doc": "Status of the purchase, such as 200 if the purchase succeeded." } ],
        "extra":
          {  },
        "labels": [] },
      { "name": "PurchaseResultFree",
        "locations":
          [ { "filename": "paid-plans.js",
              "lineno": 188 } ],
        "docs":
          { "summary": "An object representing a purchase result for a free plan.",
            "links":
              [ "[purchasePlan( )](wix-paid-plans.html#purchasePlan)" ],
            "examples":
              [ { "title": "Purchase a free plan",
                  "body":
                    [ "import wixPaidPlans from 'wix-data';",
                      "import wixPay from 'wix-paid-plans';",
                      "",
                      "let planId = // Get the plan ID for a free plan",
                      "",
                      "export function myPurchaseButton_click(event) {",
                      "  wixPaidPlans.purchasePlan(planId)",
                      "    .then( (myPurchase) => {",
                      "        let  myOrderId = myPurchase.orderId;",
                      "        let  myStatus = myPurchase.status;",
                      "    } );",
                      "  }",
                      "",
                      "",
                      "/* myPurchase:",
                      " * {",
                      " *  \"orderId\": \\\"b3fb3a4d-c223-4040-8bc3-8dfdefb1bafc\\\",",
                      " *  \"status\": 200",
                      " * }",
                      " */" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "members":
          [ { "name": "orderId",
              "type": "string",
              "doc": "ID of the order being purchased." },
            { "name": "status",
              "type": "string",
              "doc": "Status of the purchase, such as 200 if the purchase succeeded." } ],
        "extra":
          {  },
        "labels": [] } ],
  "extra":
    { "notes":
        [ "To work with the Paid Plans API, you need to publish your site." ] } }