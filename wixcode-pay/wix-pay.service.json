{ "name": "wix-pay",
  "mixes": [],
  "labels":
    [ "changed" ],
  "location":
    { "filename": "pay.js",
      "lineno": 119 },
  "docs":
    { "summary": "The wix-pay module contains functionality for working with\n payments from client-side code.",
      "description":
        [ "To process payments on your site, first set up your site to accept payments",
          " as described in <a href=\"https://support.wix.com/en/article/about-accepting-payments\" target=\"_blank\">About Accepting Payments</a>.",
          " When setting up your site to accept payments, be sure to select the payment",
          " methods you want to offer and <a href=\"https://support.wix.com/en/article/setting-your-currency-for-accepting-payments\" target=\"_blank\">set your payment currency</a>.",
          "",
          " <h3 id=\"payment-lifecycle\">Typical Payment Lifecycle</h3>",
          "",
          " The following list outlines the steps taken in a typical payment lifecycle:",
          "",
          " 1. A site visitor clicks a button to start the payment process.",
          " 1. The button's event handler calls a backend function.",
          " 1. A [`PaymentRequest`](wix-pay-backend.html#PaymentRequest) object containing information about",
          "    the payment, such as the payment amount, is created in the backend function.",
          " 1. The backend function calls [`createPayment()`](wix-pay-backend.html#createPayment) using the",
          "    [`PaymentRequest`](wix-pay-backend.html#PaymentRequest) object and returns the generated",
          "    [`Payment`](wix-pay.html#Payment) object to the calling client-side event handler.",
          " 1. The event handler then calls the [`startPayment()`](wix-pay.html#startPayment)",
          "    function with the id from the [`Payment`](wix-pay.html#Payment) object, which opens",
          "    the payment popup on your site.",
          " 1. The site visitor enters the payment information.",
          " 1. The event handler optionally handles the returned [`PaymentResult`](wix-pay.html#PaymentResult).",
          " 1. Handle additional status updates to the payment transaction using the",
          "    [`onPaymentUpdate()`](wix-pay-backend.Events.html#onPaymentUpdate) event.",
          "",
          " To use the Pay API, import `wixPay` from the `wix-pay` module:",
          "",
          "   ```javascript",
          "   import wixPay from 'wix-pay';",
          "   ```" ],
      "links": [],
      "examples": [],
      "extra":
        {  } },
  "properties": [],
  "operations":
    [ { "name": "startPayment",
        "labels":
          [ "changed" ],
        "nameParams": [],
        "params":
          [ { "name": "paymentId",
              "type": "string",
              "doc": "The payment ID from a `createPayment()` request." },
            { "name": "options",
              "type": "wix-pay.PaymentOptions",
              "doc": "Payment process options.",
              "optional": true } ],
        "ret":
          { "type":
              { "name": "Promise",
                "typeParams":
                  [ "wix-pay.PaymentResult" ] },
            "doc": "Fulfilled - The created payment." },
        "locations":
          [ { "filename": "pay.js",
              "lineno": 221 } ],
        "docs":
          { "summary": "Starts a payment.",
            "description":
              [ "Before using the startPayment() function, you will need to set up your site to",
                " accept payments. To learn more, see [About Accepting Payments](https://support.wix.com/en/article/about-accepting-payments).",
                " When setting up your site to accept payments, be sure to select the payment",
                " methods you want to offer and <a href=\"https://support.wix.com/en/article/setting-your-currency-for-accepting-payments\" target=\"_blank\">set your payment currency</a>.",
                "",
                " The `startPayment()` function returns a Promise that resolves to a [`PaymentResult`](wix-pay.html#PaymentResult)",
                " object when the user completes the payment process. Only use this result for display purposes.",
                " For business decisions, such as updating collection data, use the [`onPaymentUpdate`](wix-pay-backend.Events.html#onPaymentUpdate)",
                " event.",
                "",
                " Starting a payment prompts the user to select a payment method and continue the",
                " payment process with the options specified in the `options` parameter.",
                "",
                " Before calling `startPayment()`, call [`createPayment()`](wix-pay-backend.html#createPayment)",
                " from your site's backend to create a payment and generate a value for the `paymentId` parameter.",
                "",
                " To understand how `startPayment()` is used in a typical payment lifecycle,",
                " see [Typical Payment Lifecycle](wix-pay.html#payment-lifecycle).",
                "",
                " Use the `options` parameter to:",
                "",
                " + Determine whether a user info page is shown at the beginning of the process.",
                " + Determine whether a thank you page is shown at the end of the process.",
                " + Determine whether a terms and conditions affirmation checkbox and link are shown." ],
            "links": [],
            "examples":
              [ { "title": "Start a payment on button click",
                  "body":
                    [ "/**************************",
                      " * backend code - pay.jsw *",
                      " **************************/",
                      "",
                      "import wixPay from 'wix-pay-backend';",
                      "",
                      "export function createMyPayment() {",
                      "  return wixPay.createPayment({",
                      "    items: [{",
                      "      name: \"Product Name\",",
                      "      price: 9.99",
                      "    }],",
                      "    amount: 9.99",
                      "  });",
                      "}",
                      "",
                      "/********************",
                      " * client-side code *",
                      " ********************/",
                      "",
                      "import {createMyPayment} from 'backend/pay';",
                      "import wixPay from 'wix-pay';",
                      "",
                      "export function myButton_click(event, $w) {",
                      "  createMyPayment()",
                      "    .then( (payment) => {",
                      "      wixPay.startPayment(payment.id);",
                      "    } );",
                      "}" ],
                  "extra":
                    {  } },
                { "title": "Start a payment on button click using quantity",
                  "body":
                    [ "/**************************",
                      " * backend code - pay.jsw *",
                      " **************************/",
                      "",
                      "import wixPay from 'wix-pay-backend';",
                      "",
                      "export function createMyPayment() {",
                      "  return wixPay.createPayment({",
                      "    items: [{",
                      "      name: \"Product Name\",",
                      "      price: 9.99,",
                      "      quantity: 2",
                      "    }],",
                      "    amount: 19.98",
                      "  });",
                      "}",
                      "",
                      "/********************",
                      " * client-side code *",
                      " ********************/",
                      "",
                      "import {createMyPayment} from 'backend/pay';",
                      "import wixPay from 'wix-pay';",
                      "",
                      "export function myButton_click(event, $w) {",
                      "  createMyPayment()",
                      "    .then( (payment) => {",
                      "      wixPay.startPayment(payment.id);",
                      "    } );",
                      "}" ],
                  "extra":
                    {  } },
                { "title": "Start a payment on button click and handle status possibilities",
                  "body":
                    [ "/**************************",
                      " * backend code - pay.jsw *",
                      " **************************/",
                      "",
                      "import wixPay from 'wix-pay-backend';",
                      "",
                      "export function createMyPayment() {",
                      "  return wixPay.createPayment( {",
                      "    items: [ {",
                      "      name: \"Product Name\",",
                      "      price: 9.99",
                      "    } ],",
                      "    amount: 9.99",
                      "  } );",
                      "}",
                      "",
                      "/********************",
                      " * client-side code *",
                      " ********************/",
                      "",
                      "import {createMyPayment} from 'backend/pay';",
                      "import wixPay from 'wix-pay';",
                      "",
                      "export function myButton_click(event, $w) {",
                      "  createMyPayment()",
                      "    .then( (payment) => {",
                      "      wixPay.startPayment(payment.id)",
                      "        .then( (result) => {",
                      "          if (result.status === \"Successful\") {",
                      "            // handle payment success",
                      "          } else if (result.status === \"Failed\") {",
                      "            // handle payment failure",
                      "          } else if (result.status === \"Pending\") {",
                      "            // handle payment pending",
                      "          } else if (result.status === \"Cancelled\") {",
                      "            // handle user closing payment panel",
                      "          }",
                      "        } );",
                      "    } );",
                      "}" ],
                  "extra":
                    {  } },
                { "title": "Start a payment on button click with a custom thank you page",
                  "body":
                    [ "/**************************",
                      " * backend code - pay.jsw *",
                      " **************************/",
                      "",
                      "import wixPay from 'wix-pay-backend';",
                      "",
                      "export function createMyPayment() {",
                      "  return wixPay.createPayment({",
                      "    items: [ {",
                      "      name: \"Product Name\",",
                      "      price: 9.99",
                      "    } ],",
                      "    amount: 9.99",
                      "  } );",
                      "}",
                      "",
                      "/********************",
                      " * client-side code *",
                      " ********************/",
                      "",
                      "import {createMyPayment} from 'backend/pay';",
                      "import wixPay from 'wix-pay';",
                      "import wixWindow from 'wix-window';",
                      "",
                      "export function myButton_click(event, $w) {",
                      "  createMyPayment()",
                      "    .then( (payment) => {",
                      "      wixPay.startPayment(payment.id, {\"showThankYouPage\": false})",
                      "        .then( (result) => {",
                      "          if (result.status === \"Successful\") {",
                      "            wixWindow.openLightbox(\"Success Box\");",
                      "          } else if (result.status === \"Pending\") {",
                      "            wixWindow.openLightbox(\"Pending Box\");",
                      "          }",
                      "      } );",
                      "    } );",
                      "}" ],
                  "extra":
                    {  } },
                { "title": "Start a payment on button click with a terms and conditions link",
                  "body":
                    [ "/**************************",
                      " * backend code - pay.jsw *",
                      " **************************/",
                      "",
                      "import wixPay from 'wix-pay-backend';",
                      "",
                      "export function createMyPayment() {",
                      "  return wixPay.createPayment({",
                      "    items: [{",
                      "      name: \"Product Name\",",
                      "      price: 9.99",
                      "    }],",
                      "    amount: 9.99",
                      "  });",
                      "}",
                      "",
                      "/********************",
                      " * client-side code *",
                      " ********************/",
                      "",
                      "import {createMyPayment} from 'backend/pay';",
                      "import wixPay from 'wix-pay';",
                      "",
                      "export function myButton_click(event, $w) {",
                      "  createMyPayment()",
                      "    .then( (payment) => {",
                      "      wixPay.startPayment(payment.id, {",
                      "        \"termsAndConditionsLink\": \"https://mysite.com/terms\"",
                      "      } );",
                      "  } );",
                      "}" ],
                  "extra":
                    {  } },
                { "title": "Start a payment on button click using collection data",
                  "body":
                    [ "/**************************",
                      " * backend code - pay.jsw *",
                      " **************************/",
                      "",
                      "import wixData from 'wix-data';",
                      "import wixPay from 'wix-pay-backend';",
                      "",
                      "export async function createMyPayment(productId) {",
                      "  return wixData.get(\"productCollection\", productId)",
                      "    .then( (product) => {",
                      "      return wixPay.createPayment( {",
                      "        items: [{",
                      "          name: product.name,",
                      "          price: product.price",
                      "        }],",
                      "        amount: product.price",
                      "      } );",
                      "    } );",
                      "}",
                      "",
                      "/********************",
                      " * client-side code *",
                      " ********************/",
                      "",
                      "import {createMyPayment} from 'backend/pay';",
                      "import wixPay from 'wix-pay';",
                      "",
                      "export function myButton_click(event, $w) {",
                      "  createMyPayment(event.context.itemId)",
                      "    .then( (payment) => {",
                      "      wixPay.startPayment(payment.id);",
                      "    } );",
                      "}" ],
                  "extra":
                    {  } },
                { "title": "Start a payment on button click using collection data and a quantity",
                  "body":
                    [ "/**************************",
                      " * backend code - pay.jsw *",
                      " **************************/",
                      "",
                      "import wixData from 'wix-data';",
                      "import wixPay from 'wix-pay-backend';",
                      "",
                      "export async function createMyPayment(productId, quantity) {",
                      "  return wixData.get(\"productCollection\", productId)",
                      "    .then( (product) => {",
                      "      return wixPay.createPayment( {",
                      "        items: [{",
                      "          name: product.name,",
                      "          price: product.price,",
                      "          quantity: quantity",
                      "        }],",
                      "        amount: product.price * quantity",
                      "      } );",
                      "    } );",
                      "}",
                      "",
                      "/********************",
                      " * client-side code *",
                      " ********************/",
                      "",
                      "import {createMyPayment} from 'backend/pay';",
                      "import wixPay from 'wix-pay';",
                      "",
                      "export function myButton_click(event, $w) {",
                      "  let quantity = 2;",
                      "",
                      "  createMyPayment(event.context.itemId, quantity)",
                      "    .then( (payment) => {",
                      "      wixPay.startPayment(payment.id);",
                      "    } );",
                      "}" ],
                  "extra":
                    {  } } ],
            "extra":
              {  } },
        "extra":
          { "notes":
              [ "To work with the Pay API, you need to save and publish your site.\n\n The backend [`createPayment()`](wix-pay-backend.html#createPayment) function\n takes a `PaymentRequest` parameter that defines the information for a payment.\n For security reasons you should always create the `PaymentRequest` object\n in backend code. Do not pass payment information from client-side code.\n Doing so opens a vulnerability that a malicious user can exploit to change\n payment information, such as the price of an item being purchased.\n To learn more about how to keep your payment code secure, see\n <a href=\"https://support.wix.com/en/article/security-considerations-when-working-with-wix-code#code-visibility\" target=\"_blank\">Security Considerations When Working with Wix Code</a>." ] } } ],
  "callbacks": [],
  "messages":
    [ { "name": "Payment",
        "locations":
          [ { "filename": "pay.js",
              "lineno": 179 } ],
        "docs":
          { "summary": "An object representing a payment.",
            "links":
              [ "[startPayment( )](wix-pay.html#startPayment)",
                "[PaymentResult](wix-pay.html#PaymentResult)" ],
            "examples": [],
            "extra":
              {  } },
        "members":
          [ { "name": "id",
              "type": "string",
              "doc": "Payment transaction ID." },
            { "name": "amount",
              "type": "number",
              "doc": "Payment total amount." },
            { "name": "currency",
              "type": "string",
              "doc": "Payment currency. A three-letter\n [ISO-4217](https://en.wikipedia.org/wiki/ISO_4217) currency code." },
            { "name": "items",
              "type":
                { "name": "Array",
                  "typeParams":
                    [ "wix-pay.PaymentItem" ] },
              "doc": "Payment items." },
            { "name": "userInfo",
              "type": "wix-pay-backend.PaymentUserInfo",
              "doc": "An object representing information about the user. It will be used to prefill\n the user info form during the payment process.",
              "optional": true } ],
        "extra":
          {  },
        "labels":
          [ "changed" ] },
      { "name": "PaymentItem",
        "locations":
          [ { "filename": "pay.js",
              "lineno": 194 } ],
        "docs":
          { "summary": "An object representing a payment item.",
            "links":
              [ "[startPayment( )](wix-pay.html#startPayment)" ],
            "examples": [],
            "extra":
              {  } },
        "members":
          [ { "name": "name",
              "type": "string",
              "doc": "Payment item name." },
            { "name": "quantity",
              "type": "number",
              "doc": "Payment item quantity." },
            { "name": "price",
              "type": "number",
              "doc": "Payment item price." } ],
        "extra":
          {  },
        "labels": [] },
      { "name": "PaymentOptions",
        "locations":
          [ { "filename": "pay.js",
              "lineno": 204 } ],
        "docs":
          { "summary": "An object representing the options of a payment.",
            "links":
              [ "[startPayment( )](wix-pay.html#startPayment)" ],
            "examples": [],
            "extra":
              {  } },
        "members":
          [ { "name": "termsAndConditionsLink",
              "type": "string",
              "doc": "Absolute URL of a terms and conditions\n page. If a link is present, an agreement checkbox will be presented alongside the link.",
              "optional": true },
            { "name": "showThankYouPage",
              "type": "boolean",
              "doc": "Whether to show a thank you page. Defaults to `true`.",
              "optional": true },
            { "name": "userInfo",
              "type": "wix-pay-backend.PaymentUserInfo",
              "doc": "Deprecated: An object representing information about the user. It will be used to prefill\n user info form during payment process.\n\n Deprecation note: Pass user information to [`createPayment( )`](wix-pay-backend#createPayment) instead.",
              "optional": true },
            { "name": "skipUserInfoPage",
              "type": "boolean",
              "doc": "Whether to skip the user info page. Defaults to `false`.\n The page will be skipped only if user info was passed to [`createPayment()`](wix-pay-backend.html#createPayment) as\n a part of the [`PaymentRequest`](wix-pay-backend.html#PaymentRequest).",
              "optional": true } ],
        "extra":
          {  },
        "labels":
          [ "changed" ] },
      { "name": "PaymentResult",
        "locations":
          [ { "filename": "pay.js",
              "lineno": 159 } ],
        "docs":
          { "summary": "An object representing a payment result.",
            "links":
              [ "[startPayment( )](wix-pay.html#startPayment)" ],
            "examples": [],
            "extra":
              {  } },
        "members":
          [ { "name": "payment",
              "type": "wix-pay.Payment",
              "doc": "The payment." },
            { "name": "status",
              "type": "string",
              "doc": "Payment status. One of:\n\n + \"`Successful`\": Payment was successfully received.\n + \"`Pending`\": Payment is pending payment provider approval.\n + \"`Failed`\": Payment has failed.\n + \"`Chargeback`\": Payment is chargeback.\n + \"`Refunded`\": Payment was fully refunded.\n + \"`Offline`\": Payment will be executed offline.\n + \"`PartiallyRefunded`\": Payment was partially refunded.\n + \"`Cancelled`\": Payment was cancelled and was not processed.\n + \"`Undefined`\": Payment status is pending payment provider input." },
            { "name": "transactionId",
              "type": "string",
              "doc": "ID of the payment transaction." } ],
        "extra":
          {  },
        "labels":
          [ "changed" ] } ],
  "extra":
    { "notes":
        [ "To work with the Pay API, you need to save and publish your site." ] } }
